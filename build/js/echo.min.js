/*! echo.js v1.7.0 | (c) 2015 @toddmotto | https://github.com/toddmotto/echo */
(function(a,b){if(typeof define==="function"&&define.amd){define(function(){return b(a)})}else{if(typeof exports==="object"){module.exports=b}else{a.echo=b(a)}}})(this,function(i){var c={};var k=function(){};var e,g,f,j,d;var a=function(l){return(l.offsetParent===null)};var h=function(m,l){if(a(m)){return false}var n=m.getBoundingClientRect();return(n.right>=l.l&&n.bottom>=l.t&&n.left<=l.r&&n.top<=l.b)};var b=function(){if(!j&&!!g){return}clearTimeout(g);g=setTimeout(function(){c.render();g=null},f)};c.init=function(p){p=p||{};var n=p.offset||0;var m=p.offsetVertical||n;var o=p.offsetHorizontal||n;var l=function(q,r){return parseInt(q||r,10)};e={t:l(p.offsetTop,m),b:l(p.offsetBottom,m),l:l(p.offsetLeft,o),r:l(p.offsetRight,o)};f=l(p.throttle,250);j=p.debounce!==false;d=!!p.unload;k=p.callback||k;c.render();if(document.addEventListener){i.addEventListener("scroll",b,false);i.addEventListener("load",b,false)}else{i.attachEvent("onscroll",b);i.attachEvent("onload",b)}};c.render=function(){var m=document.querySelectorAll("img[data-echo], [data-echo-background]");var p=m.length;var q,o;var l={l:0-e.l,t:0-e.t,b:(i.innerHeight||document.documentElement.clientHeight)+e.b,r:(i.innerWidth||document.documentElement.clientWidth)+e.r};for(var n=0;n<p;n++){o=m[n];if(h(o,l)){if(d){o.setAttribute("data-echo-placeholder",o.src)}if(o.getAttribute("data-echo-background")!==null){o.style.backgroundImage="url("+o.getAttribute("data-echo-background")+")"}else{o.src=o.getAttribute("data-echo")}if(!d){o.removeAttribute("data-echo");o.removeAttribute("data-echo-background")}k(o,"load")}else{if(d&&!!(q=o.getAttribute("data-echo-placeholder"))){if(o.getAttribute("data-echo-background")!==null){o.style.backgroundImage="url("+q+")"}else{o.src=q}o.removeAttribute("data-echo-placeholder");k(o,"unload")}}}if(!p){c.detach()}};c.detach=function(){if(document.removeEventListener){i.removeEventListener("scroll",b)}else{i.detachEvent("onscroll",b)}clearTimeout(g)};return c});